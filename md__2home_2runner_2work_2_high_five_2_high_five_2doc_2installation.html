<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HighFive: Beginners Installation Guide on Linux</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HighFive<span id="projectnumber">&#160;2.10.1</span>
   </div>
   <div id="projectbrief">HighFive - Header-only C++ HDF5 interface</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__2home_2runner_2work_2_high_five_2_high_five_2doc_2installation.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Beginners Installation Guide on Linux</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>These installation instruction are aimed at developers that aren't very familiar with installing C/C++ software and using CMake on Linux.</p>
<h1>Obtaining CMake</h1>
<p>You'll need a compiler and CMake. We'll assume that a reasonably modern C++ compiler is available. Often a sufficiently new version CMake is also present on the system.</p>
<p>If not, there's two options: use the system package manager or use <code>pip</code>. CMake is improving in leaps and bounds. Which means you want a recent version. We suggest reconsidering fighting an older version of CMake if you can simply install the newest version via <code>pip</code>.</p>
<h1>Obtaining HDF5</h1>
<p>First, you need to decide if you need MPI-support. Rule of thumb is: if you're unsure, then you don't need it. If you need MPI you must install an MPI-enabled version of HDF5. Otherwise pick either one, if something is already installed, e.g. because <code>h5py</code> was installed as a system package, stick with that version.</p>
<p>The options for installing HDF5 are:</p><ol type="1">
<li>Use the system package manager.</li>
<li>On a cluster use modules.</li>
<li>Use <a href="https://github.com/spack/spack">Spack</a>.</li>
<li>Use <a href="https://conan.io">Conan</a>.</li>
<li>Manually install it.</li>
</ol>
<p>The system package manager will install HDF5 in a default location, were CMake will later be able to find it without further help. All the other approaches install into a non-default location and CMake might need help locating HDF5. The way one tells CMake where to find HDF5 is through <code>CMAKE_PREFIX_PATH</code>, e.g., </p><pre class="fragment">cmake -DCMAKE_PREFIX_PATH="${HDF5_ROOT}" ...
</pre><p> Note that <code>${HDF5_ROOT}</code> points to the folder which contains the two folders <code>include</code> and <code>lib</code>.</p>
<h2>System Package Manager</h2>
<p>The default choice is to use the system package manager to install HDF5. One thing to keep an eye out is that certain Linux distributions don't install the headers automatically. Since you're about to develop an application which (indirectly) uses HDF5, you need those headers. If the packages are split, the development package is often suffixed with <code>-dev</code> or <code>-devel</code>.</p>
<h3>Ubuntu</h3>
<p>The package manager is apt. To install the HDF5 C library without MPI support: </p><pre class="fragment">sudo apt-get install libhdf5-dev
</pre><p> for MPI support you'd install <code>libhdf5-openmpi-dev</code>.</p>
<h3>ArchLinux</h3>
<p>On ArchLinux you install </p><pre class="fragment">sudo pacman -S hdf5
</pre><p> or <code>hdf5-openmpi</code> for HDF5 with OpenMPI support.</p>
<h2>Using Modules</h2>
<p>If you're on a cluster, HDF5 has almost certainly been installed for you. Figure out how to use it. This is the preferred solution on clusters. As always, the precise instructions depend on the cluster, but something like </p><pre class="fragment">module load hdf5
</pre><p> will probably be part of the solution. Try if <code>module avail</code> helps. Otherwise, you'd need to check the documentation for your cluster. Cluster admins like to hide the good stuff, i.e. modern versions, behind another package <code>"new"</code> or some other mechanism.</p>
<p>You might need to know where HDF5 has been installed. You can find out what a module does by typing </p><pre class="fragment">module show hdf5
</pre><p> If it contains something about prepending to <code>CMAKE_PREFIX_PATH</code>, then CMake should find the correct version automatically after loading the module.</p>
<h2>Using Spack</h2>
<p>If neither of the above work, the next best choice might be Spack. It's a package manager for scientific computing. The general idea behind it is to avoid dependency issues by compiling a compatible set of everything.</p>
<p>Obtain Spack by cloning their repo: </p><pre class="fragment">git clone https://github.com/spack/spack.git
</pre><p> Activate Spack by sourcing a magic file: </p><pre class="fragment">source spack/share/spack/setup-env.sh
</pre><p> which will put the command <code>spack</code> into your <code>PATH</code>. Okay, now we're set. First step is to create an environment for your project, which we'll call <code>useful</code>: </p><pre class="fragment">spack env create useful
spack env activate -p useful
spack add hdf5
spack install --jobs NPROC
</pre><p> If you need MPI support use <code>hdf5+mpi</code> instead. The location of the HDF5 installation is <code>spack location --install-dir hdf5</code>.</p>
<h2>Conan</h2>
<p>If Spack doesn't work, you can try Conan.</p>
<h2>Manually Install HDF5</h2>
<p>If all else fails, you can try to manually install HDF5. First you need to obtain the source code. For example by using <code>git</code> or by downloading an archive from their webpage. </p><pre class="fragment">git clone https://github.com/HDFGroup/hdf5
cd hdf5
git checkout hdf5-1_14_0
</pre><p> Now, fingers crossed it'll compile and install: </p><pre class="fragment">cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=../hdf5-v1.14.0 -B build .
cmake --build build --parallel [NPROC]
cmake --install build
</pre><p> Note that here we picked the installation path (or more precisely prefix) to be <code>../hdf5-v1.14.0</code>. You might want to install HDF5 somewhere else. This installation prefix is the also the path you need to give CMake so it's able to find HDF5 later on.</p>
<h2>Confirming HDF5 Has Been Installed</h2>
<p>For this purpose we need a dummy file <code>dummy.cpp</code> to compile: </p><pre class="fragment">#include &lt;hdf5.h&gt;

int main() {
  auto file = H5Fcreate("foo.h5", H5F_ACC_EXCL, H5P_DEFAULT, H5P_DEFAULT);
  H5Fclose(file);
  return 0;
}
</pre><p> and a <code>CMakeLists.txt</code> with the following contents </p><pre class="fragment">cmake_minimum_required(VERSION 3.19)
project(Dummy)

find_package(HDF5 REQUIRED)
add_executable(dummy dummy.cpp)
target_link_libraries(dummy HDF5::HDF5)
</pre><p> Now run CMake to configure the build system and keep an eye out for some a line related to HDF5, e.g. </p><pre class="fragment">$ cmake -B build .
...
-- Found HDF5: hdf5-shared (found version "1.14.0")
...
</pre><p> Compile and check that it's doing something with sensible </p><pre class="fragment">$ cmake -build build --verbose
[ 50%] Building CXX object CMakeFiles/dummy.dir/dummy.cpp.o
/usr/bin/c++ ... -isystem ${HDF5_ROOT}/include ... -c ${PWD}/dummy.cpp
[100%] Linking CXX executable dummy
/usr/bin/c++ ... -o dummy -Wl,-rpath,${HDF5_ROOT}/lib ${HDF5_ROOT}/lib/libhdf5.so.310.0.0 ...
</pre><p> mostly you're checking that the paths are what you'd expect them to be. If this command was successful, chances are high that HDF5 is properly installed and you've figured out the correct CMake invocations. If you want you can run the executable: </p><pre class="fragment">build/dummy
</pre><p> which would create an empty file <code>foo.h5</code>.</p>
<h1>Obtaining <a class="el" href="namespace_high_five.html">HighFive</a></h1>
<p>In principle the same instruction as for HDF5 can be used. However, <a class="el" href="namespace_high_five.html">HighFive</a> is much less popular compared to HDF5 and therefore the system package manager likely doesn't know about it, nor does Conan. You're left with Spack and the manual process. It seems someone has done the wonderful work of adding <a class="el" href="namespace_high_five.html">HighFive</a> to conda-forge, so maybe that's also an option.</p>
<h2>Git Submodules</h2>
<p>This is the well-tested method for "vendoring" <a class="el" href="namespace_high_five.html">HighFive</a>, i.e. including the <a class="el" href="namespace_high_five.html">HighFive</a> sources with those of you project.</p>
<h2>Spack</h2>
<p>Similarly as for HDF5, you can use Spack to install <a class="el" href="namespace_high_five.html">HighFive</a>: </p><pre class="fragment">spack env activate -p useful
spack add highfive
spack install --jobs NPROC
</pre><p> Again <code>spack location --install-dir highfive</code> will return the path where <a class="el" href="namespace_high_five.html">HighFive</a> was installed. Since the Spack recipe of <a class="el" href="namespace_high_five.html">HighFive</a> declares HDF5 as a dependency, technically, it's not necessary to add <code>hdf5</code>, just <code>highfive</code> is enough.</p>
<h2>Manually Install <a class="el" href="namespace_high_five.html">HighFive</a></h2>
<p>Just like before the steps are, clone, configure, compile (kinda a no-op), install. The detailed instructions would be </p><pre class="fragment">git clone --recursive https://github.com/BlueBrain/HighFive.git
cd HighFive
git checkout v2.8.0
</pre><p> If it complains that Catch is missing, you forgot the <code>--recursive</code>. To fix this you type </p><pre class="fragment">git submodule update --init --recursive
</pre><p> Okay, on to configure, compile and install. The CMake commands are </p><pre class="fragment">cmake -DCMAKE_INSTALL_PREFIX=build/install -DHIGHFIVE_USE_BOOST=Off -B build .
cmake --build build --parallel
cmake --install build
</pre><p> Later you'd pass the installation directory, i.e. <code>${PWD}/build/install</code>, to <code>CMAKE_PREFIX_PATH</code>.</p>
<h2>Confirming It Works</h2>
<p>We again need a dummy file called <code>dummy.cpp</code> with the following contents </p><pre class="fragment">#include &lt;highfive/highfive.hpp&gt;

int main() {
  auto file = HighFive::File("foo.h5", HighFive::File::Create);
  return 0;
}
</pre><p> and the following <code>CMakeLists.txt</code>: </p><pre class="fragment">cmake_minimum_required(VERSION 3.19)
project(UseHighFive)

find_package(HighFive REQUIRED)
add_executable(dummy dummy.cpp)
target_link_libraries(dummy HighFive)
</pre><p> The required CMake commands are: </p><pre class="fragment">$ cmake -DCMAKE_PREFIX_PATH="${HDF5_ROOT};${HIGHFIVE_ROOT}" -B build .
...
-- HIGHFIVE 2.7.1: (Re)Detecting Highfive dependencies (HIGHFIVE_USE_INSTALL_DEPS=NO)
-- Found HDF5: hdf5-shared (found version "1.14.0")
...

$ cmake --build build --verbose
[ 50%] Building CXX object CMakeFiles/dummy.dir/dummy.cpp.o
/usr/bin/c++ ... -isystem ${HIGHFIVE_ROOT}/include -isystem ${HDF5_ROOT}/include ... -c dummy.cpp
[100%] Linking CXX executable dummy
/usr/bin/c++ ... -o dummy -Wl,-rpath,${HDF5_ROOT}/lib ${HDF5_ROOT}/lib/libhdf5.so.310.0.0 ...
</pre><p> Pay attention to the semi-colon (not colon like the rest of Linux) used to separate directories in <code>CMAKE_PREFIX_PATH</code>. If this worked you should be set to either copy the instruction to your "real" project, or start developing the rest of your project. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
